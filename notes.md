# 这是一个笔记，关于学习SM2的  

## 基于椭圆曲线上的离散对数难题的非对称密码算法

### 什么是椭圆曲线？

#### 对椭圆曲线的向下解释

椭圆曲线方程：$y^2+axy+by = x^3+cx^2+dx+e$ 或简化为：$4y^2 = x^3+ax+b$  
这里的椭圆曲线是在**有限域上**的椭圆曲线  
**有限域**是啥？ 是一个带有有限阶数的**域**  
而**域**又是啥？是一个满足特定条件的**环**  
**环**呢？ 是两个**群**（交换群、半群）组合成的  
**群**呢？ 群是一个满足一定条件的**代数结构**  
一个非空集合在一种运算上是封闭的，那这种运算与这个集合就构成了一个**代数结构**

#### 到这算是解释完毕了，然后我们加入条件，向上还原

一个非空集合在一种运算上是封闭的，那这种运算与这个集合就构成了一个**代数结构**
**代数结构**满足*结合律*叫**半群**，在这基础上又满足*幺元律、逆元律、交换律*就叫**交换群**  
当两个**群**（集合相同）的*运算满足分配律*时，这两个群就组合成**环**  
当**环**中的**半群**去掉零元后可以*变成交换群*时，这个环升格成为**域**  
*有限阶数*后就变成了**有限域**  
**椭圆曲线**还是那个熟悉的函数，但因为*有限域的限制*，所以它变成了一个**点集**，且加上了一个mod(p)的步骤  
数学表示：$E_p(a,b) = \{ (x,y) | \equiv x^3 + ax + b (mod\ p),x,y \in Z_p\}\cup\{ O \}$  
（其实有限域上的椭圆曲线定义还有一个限制，就是$4a^3+26b^2 mod (p)$）  
麻烦是吗？但是，还记得我们说**有限域上的椭圆曲线是会被限制成为点集**吗？  
这个点集会构成一个**循环群**，而**无限远点O就是它的幺元**。  
所以真正和我们打交道的不过是**一个由点构成的循环群**罢了（bushi)  

#### SM2上的椭圆曲线

当我们碰到SM2时，情况**好像**又升级了  
两条椭圆曲线基于有两个有限域，一个叫素域（粟裕）一个叫扩域（蛞蝓）（md首选词没一个对的）

**素域**是没有子域的有限域，**扩域**是某个子域的扩  
注意的是这里要求子域里面最底层的两个子群都必须还能一层层上来构成域  
但目前来看我还没有弄明白为什么要是这两种域……

### 椭圆曲线上的运算

因为这里只有有限域上的，因此我们**只讨论有限域上的情况**（其实实数域上的也差不多就是了）  
首先是关于零点（无限远点）的：$P+O=O+P=P$  
然后是关于负元的：$P$的负元是$-P(x,p-y)$（对p就是$E_p$的那个p），$P+-P = O$  
**最后也是最重要**的：$P(x_1,y_1)+Q(x_2,y_2) = R(x_3,y_3)$  
$x_3 = k^2-x_1-x_2(mod\ p),y_3=k(x_1-x_3)-y_1(mod\ p)$  
其中，$k= \frac{y_1-y_2}{x_1-x_2}(mod\ p) $或 $k= \frac{3x^2+a}{2y}(mod\ p)$

### 椭圆曲线上的N倍点

当点$Q=P+P+....+P$($n$个$P$相加)时，称$Q$为$P$的$n$倍点，记作$Q=[n]P$

### 椭圆曲线上的离散对数难题

当知道点$P$与其倍点$Q$之后，问：$Q$是$P$的几倍点？  
能否通过两点坐标直接计算倍数呢？答案是不能。  
唯一的方法是通过计算2倍点、3倍点...一步步上来，或者随机算撞大运，直到坐标相等。  
这样，倍点计算就构成了一个单向函数，逆向计算倍点数也就是椭圆曲线上的离散对数难题。

## 数据类型

上面学了那么多，还没有开始接触算法...  
到数据类型这里我们距离SM2更近一步  
在GB/T 329181-2016中，一共有5中数据类型：比特串、字节串、整数、域元素、点

### 每种类型（不怎么）详细的 介绍

比特串：有序0 1序列  
字节串：有序字节序列  
整数：非负整数（无符号数）  
对于计算机专业的同学不需要解释就能弄懂

域元素：有限域$F_q$上的元素  
椭圆曲线上的点：椭圆曲线当然是那个被限制后的椭圆曲线，也就是说这个那个循环群的元素  
这两种特殊的数据类型实际上就是整数或者比特串，不过对于不同的有限域下的椭圆曲线有着不同的类型

### 数据类型间的转换

这个标题要写的内容较多，我打算直接参考国标文件而不在此赘述

## SM2算法

### 非对称

SM2作为非对称密码算法，应该有两种应用环境：

1. 作为非对称密码算法进行加密与解密  
2. 作为签名算法进行文件的签名与验签

在国标中，签名算法写在第二章中，而非对称密码算法写在第四章中，后文我按照国标顺序写。

### 签名算法

#### 签名



#### 验签

### 非对称密码算法

#### 加密过程

#### 解密过程
